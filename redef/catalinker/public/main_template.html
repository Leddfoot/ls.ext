<div class="content">
    <h2 data-automation-id="page-heading">Katalogisering av utgivelse</h2>

    <div class="grid-input">
        <div class="pure-g" style="height: 0px;">
            <div class="pure-u-1-2" id="left-dummy-panel"/>
            <div class="pure-u-1-2" id="right-dummy-panel"/>
        </div>
        <ul class="grid-tabs pure-g" id="workflow-tabs">
            {{#each inputGroups}}
            <li class="grid-tab pure-u">
                <a class="{{tabSelected ? 'grid-tab-link-selected' : ''}} grid-tab-link {{#tabEnabled(tabSelected,domain)}}{{else}}disabled{{/}}"
                   id="{{tabId}}-tab"
                   data-toggle="tab" role="tab" on-click="{{#tabEnabled(tabSelected,domain)}}activateTab{{/}}">{{tabLabel}}</a>
            </li>
            {{/each}}
        </ul>
        <div class="grid-content tab-content">
            <div class="inner-content">
                {{#each inputGroups}}
                <div id="{{tabId}}" class="grid-panel {{tabSelected ? 'grid-panel-selected -selected' : ''}} pure-g">
                    {{#each inputs}}
                    {{>input}}
                    {{/each}}
                    <div class="pure-u-1-2">
                        {{#nextStep}}
                        <button class="pure-button pure-button-primary next-step-button"
                                disabled="{{!nextStepEnabled(domain)}}" on-click="nextStep:{{.}}">{{buttonLabel}}
                        </button>
                        {{/nextStep}}
                    </div>
                </div>
                {{/each}}
            </div>
            <div class="pure-g links">
                {{#targetUri.Work}}
                <div class="pure-u-1">
                    <a data-automation-id="work_page_link" target="_blank"
                       href="{{targetUri.Work.replace(':8005', ':8000')}}">Vis siden for verket</a>
                </div>
                {{/}}
                {{#targetUri.Publication}}
                <div class="pure-u-1">
                    <a data-automation-id="biblio_record_link" target="_blank"
                       href="{{config.kohaIntraUri}}/cgi-bin/koha/catalogue/detail.pl?biblionumber={{publicationId()}}"
                       class="link">Vis
                        <utgivelsen></utgivelsen>
                        i Koha</a>
                </div>
                {{/}}
            </div>
        </div>
    </div>
</div>
<div class="footer">
    <div id="errors">{{#errors}}<p>{{.}}</p>{{/errors}}</div>
    <div id="save-stat">{{save_status}}</div>
</div>

{{#partial input}}
<div class="input-panel pure-u-1-1" decorator="repositionSupportPanel">
    <fieldset class="pure-u-1-2">
        <label>{{label}}</label>
        {{#each values}}
        {{>type }}
        {{#predicate === (config.ontologyUri + "#recordID") && current.value !== ""}}
        <a data-automation-id="biblio_record_link" target="_blank"
           href="{{config.kohaIntraUri}}/cgi-bin/koha/catalogue/detail.pl?biblionumber={{current.value}}"
           class="link"></a>
        {{/}}
        {{#predicate === (config.ontologyUri + "#publicationOf") && current.value !== ""}}
        <a data-automation-id="work_page_link" target="_blank" href="{{current.value.replace(':8005',':8000')}}"
           class="link"></a>
        {{/}}
        <div class="invalid-msg">{{#error}}{{error}}{{/error}}</div>
        {{/each}}
    </fieldset>
    <span class="support-panel">
        {{>"support-for-"+type}}
    </span>
</div>
{{/partial}}
{{#partial support-for-input-string-searchable}}
{{#search_result}}
<div class="prop-search-results">
    <form action="">
        {{#results.hits.hits}}
        {{#with _source.person}}
        <div class="search-result pure-g" data-automation-id="{{uri}}">
            <div class="pure-u-1">
                <div class="pure-g">
                    <div class="pure-u-1-12">
                        <input class="select-creator-radio" type="radio"
                               on-click="selectPersonResource:{{predicate}},{{origin}}"
                               checked="{{isChecked}}"/>
                    </div>

                    <div class="pure-u-5-6">
                        <p class="creator-name">{{name}}</p>
                    </div>

                    <div class="pure-u-1-12">
                        {{#work.length}}<span on-click="toggleWork">{{#toggleWork}}&#x25B2;{{else}}&#x25BC;{{/toggleWork}}</span>{{/}}
                    </div>
                </div>

                <div class="pure-g">
                    <div class="pure-u-1-12"></div>
                    <div class="pure-u-9-12">
                        <small><span class="birth-and-death">{{#birth}}f. <span
                                class="birthYear">{{birth}}</span> - {{#death}}d. <span
                                class="deathYear">{{death}}</span>{{/death}}{{/birth}}</span></small>
                    </div>
                </div>

                {{#toggleWork}}
                <div class="work-items pure-u-1">
                    {{#work}}
                    <div class="search-result-subitem pure-g">
                        <span class="search-result-work-name pure-u-18-24">{{title}}</span>
                        <span class="search-result-work-year pure-u-4-24">{{#year}}{{year}}{{/year}}</span>
                    <span class="search-result-work-selector pure-u-2-24">
                        <input class="select-work-radio" type="radio" checked="{{isChecked}}"
                               on-click="setResourceAndWorkResource:{{../../../person}},{{predicate}},{{origin}},'Person'"/>
                    </span>
                    </div>
                    {{/work}}
                </div>
                {{/toggleWork}}
            </div>
        </div>
        {{/with}}
        {{/results}}
        {{#results.hits.hits.length}}
        <div class="search-result pure-g">
            <div class="pure-u-1">
                <button class="pure-button">Last fler</button>
            </div>
        </div>
        {{/}}
    </form>
</div>
{{/search_result}}


{{/partial}}
{{#partial select-authorized-language}}
<select
        class="authorized"
        data-automation-id="{{predicate}}_{{@index}}"
        on-change='patchResource:{{predicate}},{{this}},{{rdfType}}'
        on-keyup="countdownToSave"
        value="{{current.value}}">
    <option value="">(ikke valgt)</option>
    {{#each authorized_values.language }}
    <option value='{{.["@id"]}}'>{{.["rdfs:label"]["@value"]}}</option>
    {{/each}}
</select>
{{/partial}}

{{#partial select-authorized-format}}
<select
        class="authorized"
        data-automation-id="{{predicate}}_{{@index}}"
        on-change='patchResource:{{predicate}},{{this}},{{rdfType}}'
        on-keyup="countdownToSave"
        value="{{current.value}}">
    <option value="">(ikke valgt)</option>
    {{#each authorized_values.format }}
    <option value='{{.["@id"]}}'>{{.["rdfs:label"]["@value"]}}</option>
    {{/each}}
</select>
{{/partial}}

{{#partial select-authorized-nationality}}
<select
        class="authorized"
        data-automation-id="{{predicate}}_{{@index}}"
        on-change='patchResource:{{predicate}},{{this}},{{rdfType}}'
        on-keyup="countdownToSave"
        value="{{current.value}}">
    <option value="">(ikke valgt)</option>
    {{#each authorized_values.nationality }}
    <option value='{{.["@id"]}}'>{{.["rdfs:label"]["@value"]}}</option>
    {{/each}}
</select>
{{/partial}}

{{#partial input-string}}
<input
        {{#disabled}} disabled="true" {{/}}
class="{{#error}}invalid-input{{else}}valid{{/error}}"
on-blur='patchResource:{{predicate}},{{this}},{{rdfType}}'
on-keyup="countdownToSave"
on-change="countdownToSave"
data-automation-id="{{predicate}}_{{@index}}"
value="{{current.value}}" />
{{/partial}}

{{#partial input-string-searchable}}
<input data-value="{{current.value}}"
       {{#deletable}}readonly {{/deletable}}
on-click="{{#deletable}}unselectWorkAndPerson{{/deletable}}:{{predicate}}"
class="{{#error}}invalid-input{{else}}valid{{/error}}{{#searchable}} searchable{{/searchable}}{{#deletable}} deletable{{/deletable}}"
data-automation-id="{{predicate}}_{{@index}}"
on-enter='searchResource:{{predicate}}, {{current.displayValue}}'
value="{{current.displayValue}}" />
{{/partial}}


{{#partial input-lang-string}}
<input
        {{#disabled}} disabled="true" {{/}}
class="{{#error}}invalid-input{{else}}valid{{/error}}"
on-blur='patchResource:{{predicate}},{{this}},{{rdfType}}'
on-keyup="countdownToSave"
on-change="countdownToSave"
data-automation-id="{{predicate}}_{{@index}}"
value="{{current.value}}" />
<select value="{{current.lang}}" on-change='patchResource:{{predicate}},' class="select_lang">
    <option value="">velg spr√•k</option>
    <option value="no">norsk</option>
    <option value="en">engelsk</option>
    <option value="fr">fransk</option>
</select>
{{/partial}}

{{#partial input-gYear}}
<input
        {{#disabled}} disabled="true" {{/}}
class="{{#error}}invalid-input{{else}}valid{{/error}}"
on-blur='patchResource:{{predicate}},{{this}},{{rdfType}}'
on-keyup="countdownToSave"
data-automation-id="{{predicate}}_{{@index}}"
value="{{current.value}}" />
{{/partial}}

{{#partial input-nonNegativeInteger}}
<input
        {{#disabled}} disabled="true" {{/}}
class="{{#error}}invalid-input{{else}}valid{{/error}}"
on-blur='patchResource:{{predicate}},{{this}},{{rdfType}}'
on-keyup="countdownToSave"
on-change="countdownToSave"
data-automation-id="{{predicate}}_{{@index}},rdfType"
value="{{current.value}}" />
{{/partial}}